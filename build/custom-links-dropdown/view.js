!function(){"use strict";class e{constructor(e){this.domNode=e,this.buttonNode=e.querySelector("button"),this.menuNode=e.querySelector('[role="menu"]'),this.menuitemNodes=[],this.firstMenuitem=!1,this.lastMenuitem=!1,this.firstChars=[],this.buttonNode.addEventListener("keydown",this.onButtonKeydown.bind(this)),this.buttonNode.addEventListener("click",this.onButtonClick.bind(this));for(var t=e.querySelectorAll('[role="menuitem"]'),s=0;s<t.length;s++){var o=t[s];this.menuitemNodes.push(o),o.tabIndex=-1,this.firstChars.push(o.textContent.trim()[0].toLowerCase()),o.addEventListener("keydown",this.onMenuitemKeydown.bind(this)),o.addEventListener("mouseover",this.onMenuitemMouseover.bind(this)),this.firstMenuitem||(this.firstMenuitem=o),this.lastMenuitem=o}e.addEventListener("focusin",this.onFocusin.bind(this)),e.addEventListener("focusout",this.onFocusout.bind(this)),window.addEventListener("mousedown",this.onBackgroundMousedown.bind(this),!0)}setFocusToMenuitem(e){this.menuitemNodes.forEach((function(t){t===e?(t.tabIndex=0,e.focus()):t.tabIndex=-1}))}setFocusToFirstMenuitem(){this.setFocusToMenuitem(this.firstMenuitem)}setFocusToLastMenuitem(){this.setFocusToMenuitem(this.lastMenuitem)}setFocusToPreviousMenuitem(e){var t,s;return e===this.firstMenuitem?t=this.lastMenuitem:(s=this.menuitemNodes.indexOf(e),t=this.menuitemNodes[s-1]),this.setFocusToMenuitem(t),t}setFocusToNextMenuitem(e){var t,s;return e===this.lastMenuitem?t=this.firstMenuitem:(s=this.menuitemNodes.indexOf(e),t=this.menuitemNodes[s+1]),this.setFocusToMenuitem(t),t}setFocusByFirstCharacter(e,t){var s,o;t.length>1||(t=t.toLowerCase(),(s=this.menuitemNodes.indexOf(e)+1)>=this.menuitemNodes.length&&(s=0),-1===(o=this.firstChars.indexOf(t,s))&&(o=this.firstChars.indexOf(t,0)),o>-1&&this.setFocusToMenuitem(this.menuitemNodes[o]))}getIndexFirstChars(e,t){for(var s=e;s<this.firstChars.length;s++)if(t===this.firstChars[s])return s;return-1}openPopup(){this.menuNode.style.display="block",this.buttonNode.setAttribute("aria-expanded","true")}closePopup(){this.isOpen()&&(this.buttonNode.setAttribute("aria-expanded","false"),this.menuNode.style.display="none")}isOpen(){return"true"===this.buttonNode.getAttribute("aria-expanded")}onFocusin(){this.domNode.classList.add("focus")}onFocusout(){this.domNode.classList.remove("focus")}onButtonKeydown(e){var t=!1;switch(e.key){case" ":case"Enter":case"ArrowDown":case"Down":this.openPopup(),this.setFocusToFirstMenuitem(),t=!0;break;case"Esc":case"Escape":this.closePopup(),this.buttonNode.focus(),t=!0;break;case"Up":case"ArrowUp":this.openPopup(),this.setFocusToLastMenuitem(),t=!0}t&&(e.stopPropagation(),e.preventDefault())}onButtonClick(e){this.isOpen()?(this.closePopup(),this.buttonNode.focus()):(this.openPopup(),this.setFocusToFirstMenuitem()),e.stopPropagation(),e.preventDefault()}onMenuitemKeydown(e){var t=e.currentTarget,s=e.key,o=!1;function i(e){return 1===e.length&&e.match(/\S/)}if(!(e.ctrlKey||e.altKey||e.metaKey)){if(e.shiftKey)i(s)&&(this.setFocusByFirstCharacter(t,s),o=!0),"Tab"===e.key&&(this.buttonNode.focus(),this.closePopup(),o=!0);else switch(s){case" ":window.location.href=t.href;break;case"Esc":case"Escape":this.closePopup(),this.buttonNode.focus(),o=!0;break;case"Up":case"ArrowUp":this.setFocusToPreviousMenuitem(t),o=!0;break;case"ArrowDown":case"Down":this.setFocusToNextMenuitem(t),o=!0;break;case"Home":case"PageUp":this.setFocusToFirstMenuitem(),o=!0;break;case"End":case"PageDown":this.setFocusToLastMenuitem(),o=!0;break;case"Tab":this.closePopup();break;default:i(s)&&(this.setFocusByFirstCharacter(t,s),o=!0)}o&&(e.stopPropagation(),e.preventDefault())}}onMenuitemMouseover(e){e.currentTarget.focus()}onBackgroundMousedown(e){this.domNode.contains(e.target)||this.isOpen()&&(this.closePopup(),this.buttonNode.focus())}}window.addEventListener("load",(function(){var t=document.querySelectorAll(".cll-dropdown-links");for(let s=0;s<t.length;s++)new e(t[s])}))}();